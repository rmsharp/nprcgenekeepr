<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generates a kinship matrix. — kinship • nprcgenekeepr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generates a kinship matrix. — kinship"><meta name="description" content="{Kinship Matrix Functions} {
The code for the kinship function was written by Terry Therneau
at the Mayo clinic and taken from his website. This function is part of a
package written in S (and later ported to R) for calculating kinship and
other statistics.
}"><meta property="og:description" content="{Kinship Matrix Functions} {
The code for the kinship function was written by Terry Therneau
at the Mayo clinic and taken from his website. This function is part of a
package written in S (and later ported to R) for calculating kinship and
other statistics.
}"><meta property="og:image" content="https://github.com/rmsharp/nprcgenekeepr/reference/figures/card.png"><meta property="og:image:alt" content="Conserve Genes"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nprcgenekeepr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a2interactive.html">Interactive Use of nprcgenekeepr</a></li>
    <li><a class="dropdown-item" href="../articles/a3manual.html">Genetic Management Tools Manual</a></li>
    <li><a class="dropdown-item" href="../articles/ColonyManagerTutorial.html">GeneKeepR: A Colony Manager's Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/shiny_app_use.html">GeneKeepR Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/simulatedKValues.html">Quick Example of Simulated Kinships with Partial Parentage</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/rmsharp/nprcgenekeepr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generates a kinship matrix.</h1>
      <small class="dont-index">Source: <a href="https://github.com/rmsharp/nprcgenekeepr/blob/master/R/kinship.R"><code>R/kinship.R</code></a></small>
      <div class="d-none name"><code>kinship.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>{Kinship Matrix Functions} {
The code for the kinship function was written by Terry Therneau
at the Mayo clinic and taken from his website. This function is part of a
package written in S (and later ported to R) for calculating kinship and
other statistics.
}</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kinship</span><span class="op">(</span><span class="va">id</span>, <span class="va">father.id</span>, <span class="va">mother.id</span>, <span class="va">pdepth</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>character vector of IDs for a set of animals.</p></dd>


<dt id="arg-father-id">father.id<a class="anchor" aria-label="anchor" href="#arg-father-id"></a></dt>
<dd><p>character vector or NA for the IDs of the sires for the set
of animals.</p></dd>


<dt id="arg-mother-id">mother.id<a class="anchor" aria-label="anchor" href="#arg-mother-id"></a></dt>
<dd><p>character vector or NA for the IDs of the dams for the set
of animals.</p></dd>


<dt id="arg-pdepth">pdepth<a class="anchor" aria-label="anchor" href="#arg-pdepth"></a></dt>
<dd><p>integer vector indicating the generation number for each
animal.</p></dd>


<dt id="arg-sparse">sparse<a class="anchor" aria-label="anchor" href="#arg-sparse"></a></dt>
<dd><p>logical flag. If <code>TRUE</code>, <code>Matrix::Diagnol()</code> is
used to make a unit diagonal matrix. If <code>FALSE</code>, <code><a href="https://rdrr.io/r/base/diag.html" class="external-link">base::diag()</a></code> is
used to make a unit square matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A kinship square matrix</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function previously had an internal call to the kindepth function in
order to provide the parameter pdepth (the generation number). This version
requires the generation number to be calculated elsewhere and passed into
the function.</p>
<p>The rows (cols) of founders are just .5 * identity matrix, no further
processing is needed for them.
Parents must be processed before their children, and then a child's
kinship is just a sum of the kinship's for his/her parents.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>{S-Plus/R Function Page}
<em>www.mayo.edu/research/departments-divisions/department-health-sciences-research/division-biomedical-statistics-informatics/software/</em>
@description {s-plus-r-functions} {Downloaded 2014-08-26}
This page address is now (2019-10-03) stale.</p>
<p>All of the code on the S-Plus page was stated to be released under the
GNU General Public License (version 2 or later).</p>
<p>The R version became the kinship2 package available on CRAN:</p>
<p><a href="https://cran.r-project.org/package=kinship2" class="external-link">https://cran.r-project.org/package=kinship2</a></p>
<p>$Id: kinship.s,v 1.5 2003/01/04 19:07:53 therneau Exp $</p>
<p>{Create the kinship matrix, using the algorithm of K Lange,
Mathematical and Statistical Methods for Genetic Analysis,
Springer, 1997, p 71-72.}</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>{Terry M. Therneau, Mayo Clinic (mayo.edu), original version}</p>
<p>{as modified by, M Raboin, 2014-09-08 14:44:26}</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rmsharp.github.io/nprcgenekeepr/" class="external-link">nprcgenekeepr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ped</span> <span class="op">&lt;-</span> <span class="fu">nprcgenekeepr</span><span class="fu">::</span><span class="va"><a href="lacy1989Ped.html">lacy1989Ped</a></span></span></span>
<span class="r-in"><span><span class="va">ped</span><span class="op">$</span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="findGeneration.html">findGeneration</a></span><span class="op">(</span><span class="va">ped</span><span class="op">$</span><span class="va">id</span>, <span class="va">ped</span><span class="op">$</span><span class="va">sire</span>, <span class="va">ped</span><span class="op">$</span><span class="va">dam</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">kmat</span> <span class="op">&lt;-</span> <span class="fu">kinship</span><span class="op">(</span><span class="va">ped</span><span class="op">$</span><span class="va">id</span>, <span class="va">ped</span><span class="op">$</span><span class="va">sire</span>, <span class="va">ped</span><span class="op">$</span><span class="va">dam</span>, <span class="va">ped</span><span class="op">$</span><span class="va">gen</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ped</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id sire  dam gen population</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  A &lt;NA&gt; &lt;NA&gt;   0       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  B &lt;NA&gt; &lt;NA&gt;   0       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  C    A    B   1       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  D    A    B   1       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  E &lt;NA&gt; &lt;NA&gt;   0       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  F    D    E   2       TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  G    D    E   2       TRUE</span>
<span class="r-in"><span><span class="va">kmat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       A     B     C    D    E     F     G</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 0.500 0.000 0.250 0.25 0.00 0.125 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B 0.000 0.500 0.250 0.25 0.00 0.125 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C 0.250 0.250 0.500 0.25 0.00 0.125 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D 0.250 0.250 0.250 0.50 0.00 0.250 0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E 0.000 0.000 0.000 0.00 0.50 0.250 0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F 0.125 0.125 0.125 0.25 0.25 0.500 0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G 0.125 0.125 0.125 0.25 0.25 0.250 0.500</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Raboin, Terry Therneau, Amanda Vinson, R. Mark Sharp, Matthew Schultz, Southwest National Primate Research Center NIH grant P51 RR13986, Oregon National Primate Research Center grant P51 OD011092.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

